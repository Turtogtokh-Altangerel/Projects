from matplotlib import pyplot
import visualkeras
from PIL import ImageFont


#plotting diagnostic learning curves
def summarize_diagnostics(history):
	#plotting loss
	pyplot.title('Cross Entropy Loss')
	pyplot.plot(history.history['loss'], color='blue', label='train')
	pyplot.plot(history.history['val_loss'], color='orange', label='test')
	pyplot.ylabel('loss')
	pyplot.xlabel('epoch')
	pyplot.legend(['train', 'val'], loc='upper left')
	#saving plot image
	pyplot.savefig('loss_plot.png')
	pyplot.close()
	#plotting accuracy
	pyplot.title('Classification Accuracy')
	pyplot.plot(history.history['accuracy'], color='blue', label='train')
	pyplot.plot(history.history['val_accuracy'], color='orange', label='test')
	pyplot.ylabel('accuracy')
	pyplot.xlabel('epoch')
	pyplot.legend(['train', 'val'], loc='upper left')
	#saving plot image
	pyplot.savefig('acc_plot.png')
	pyplot.close() 


#pie chart for dataset
def plot_dataset(sizes):
	labels = 'Train', 'Validation', 'Test'
	ax1 = pyplot.subplots()
	explode = (0, 0, 0.1) 
	ax1.pie(sizes, explode=explode, labels=labels,autopct='%1.1f%%',
        shadow=True, startangle=90)
	pyplot.show()
	pyplot.savefig('dataset_pie.png')


#graphical illustration of the model
def visualize_model(model) :
	font = ImageFont.truetype("arial.ttf", 32)
	visualkeras.layered_view(model, legend=True, font = font, to_file='model_visual.png').show() 
